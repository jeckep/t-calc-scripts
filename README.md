Это репозиторий содержит скрипт для подготовки данных портфеля перед загрузкой в https://t-calc.ru для анализа.

## До установки скрипта
1. Выпустите новый токен на чтение по ссылке: https://www.tinkoff.ru/invest/settings/api/, следуя [инструкции](https://t-calc.ru/docs/get-token/). Токен может быть выпущен как на один брокерский счет, так и на все сразу.
   Сохраните токен куда-нибудь (или в файл tokens.txt).

## Простая установка для Windows (10 и выше)
1. Скачайте последнюю [версию скрипта](https://github.com/jeckep/t-calc-scripts/archive/refs/tags/v0.2.zip) и распакуйте
2. В распакованной папке двойной клик на run.bat

## Запуск скрипта
Для Windows:
1. Двойной клик на [run.bat](./run.bat)

либо 
1. Откройте PowerShell в папке скрипта
2. Введите в PowerShell команду и нажмите Enter
    ```
    node --no-warnings script.js 
    ```
## Файл tokens.txt
Если рядом с файлом script.js создать файл tokens.txt и сохранить туда токен или токены,
то не нужно будет вводить токен каждый раз при обновлении данных портфелей.

## Пошаговая установка Windows (10 и выше)

1. Скачайте файл [scripts.js](./script.js) 
2. папке где находится скачанный script.js откройте PowerShell (тут вероятно нужна инструкция как это сделать)
3. Установите программу для запуска скрипта (официальная инструкция тут: https://nodejs.org/en/download, на русском увы нет) ниже шаги оттуда
4. Установить менеджер fnm (скопируйте строку ниже в PowerShell и нажмите Enter) 
    ```
    winget install Schniz.fnm  
    ```
5. Установить node (скопируйте строку ниже в PowerShell и нажмите Enter)
    ```
    fnm install 22  
    ```
6. Проверьте версию node, команда ниже должна вернуть v22.13.0 (цифры могут отличаться главное чтобы в начале было 22) (скопируйте строку ниже в PowerShell и нажмите Enter)
    ```
    node -v  
    ```
7. Запустите скрипт (скопируйте строку ниже в PowerShell и нажмите Enter)   
    ```
    node --no-warnings script.js 
    ```
8. Скопируйте токен в PowerShell, правой кнопкой мыши Paste
9. В папке со скриптом должен появится файл: t-calc-data.json
10. Готово! Чтобы время от времени загружать новые данные достаточно шагов 7-8 (шага 8 можно избежать сохранив токен в файл tokens.txt, рядом с файлом scripts.js)

   
## Описание скрипта ([scripts.js](./script.js))

Скрипт представляет собой текстовый файл, написанный на nodejs, и может быть легко проверен любым программистом,
который подтвердит, что скрипт делает только то что оговорено. А именно скрипт, используя токен, обращается к API Т Инвестиций,
и получает оттуда данные о счетах, включая данные об операциях вводы и вывода средств.
Этих данных достаточно для проведения анализа доходности портфелей. Стоит заметить, что результатом скрипта являются текстовый файл,
который также может быть проверен визуально. Он не содержит ни токена, ни персональной информации клиента.
Другими словами по этим данным нельзя понять кому они принадлежат.

